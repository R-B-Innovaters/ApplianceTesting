@model ApplianceTesting.Models.UserModel

<div class="container card p-5" style="margin-top:5%">
    <h3>Assign Role and Manage Credentials</h3>
    <hr />
    <form asp-action="CredentialManage" asp-controller="Master" method="post">
        <div class="row">
            <div class="col-sm-12">
                <div class="row">
                    <div class="col-md-4 mb-2">
                        <label class="form-label">Role Name</label>
                        <select id="RoleId" name="RoleId" class="form-control">
                            <option value="">-- Select Role --</option>
                            @if (ViewBag.roleDDL != null)
                            {
                                foreach (var comp in ViewBag.roleDDL)
                                {
                                    <option value="@comp.RoleId">@comp.RoleName</option>

                                }
                            }
                        </select>
                    </div>
                    <div class="col-md-4 mb-2">
                        <label class="form-label">Compnany</label><br />
                        <select id="CompanyId" name="CompanyId" class="form-control">
                            <option value="">-- Select Company --</option>
                            @if (ViewBag.compDDL != null)
                            {
                                foreach (var comp in ViewBag.compDDL)
                                {

                                    <option value="@comp.CompanyId">@comp.CompanyName</option>

                                }
                            }
                        </select>
                    </div>
                </div>
                <div class="row float-end">
                    <div class="col-md-12 mb-2">
                        <button type="reset" class="btn btn-secondary">Cancel</button>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <h3>Records</h3>
    <hr />
    <table class="table" id="myTable">
        <thead>
            <tr>
                <th>Username</th>
                <th>Email</th>
                <th>Password</th>
                <th>Role Name</th>
                <th>Status</th>
            </tr>
        </thead>
        @if (ViewBag.UserList != null)
        {
            foreach (var item in ViewBag.UserList)
            {
                <tr>
                    <td>@item.Username</td>
                    <td>@item.Email</td>
                    <td>
                        <!-- Initially, show masked password -->
                        <span class="password-mask" style="display:none;">@item.Password</span>
                        <span class="password-blur" style="filter: blur(6px);">******</span>
                        <button class="btn btn-sm btn-primary toggle-password" data-userid="@item.UserId">Show</button>

                    </td>
                    <td>@item.RoleName</td>
                    <td>
                        <label class="switch">
                            <input type="checkbox" class="status-switch" data-id="@item.UserId" data-table="UserMaster" @(item.isActive ? "checked" : "") data-idcolumn="UserId" data-stcolumn="isActive">
                            <span class="slider round"></span>
                        </label>
                    </td>
                </tr>
            }
        }
    </table>
   @*  <table class="table" id="myTable">
        <thead>
            <tr>
                <th>Username</th>
                <th>Email</th>
                <th>Password</th>
                <th>Role Name</th>
                <th>Status</th>
            </tr>
        </thead>
        @if (ViewBag.UserList != null)
        {
            foreach (var item in ViewBag.UserList)
            {
                <tr>
                    <td>@item.Username</td>
                    <td>@item.Email</td>
                    <td>@item.Password</td>
                    <td>@item.RoleName</td>
                    <td>
                        <label class="switch">
                            <input type="checkbox" class="status-switch" data-id="@item.UserId" data-table="UserMaster" @(item.isActive ? "checked" : "") data-idcolumn="UserId" data-stcolumn="isActive">
                            <span class="slider round"></span>
                        </label>
                    </td>
                </tr>
            }
        }

    </table> *@


    <script>
        // Toggle password visibility on button click
        document.querySelectorAll('.toggle-password').forEach(function (button) {
            button.addEventListener('click', function () {
                const userId = this.getAttribute('data-userid');
                const passwordBlur = this.previousElementSibling; // span with blurred text
                const passwordMask = passwordBlur.previousElementSibling; // span with actual password

                // Toggle visibility
                if (passwordBlur.style.display === 'none') {
                    passwordBlur.style.display = 'inline';
                    passwordMask.style.display = 'none';
                    this.textContent = 'Show';
                } else {
                    passwordBlur.style.display = 'none';
                    passwordMask.style.display = 'inline';
                    this.textContent = 'Hide';
                }
            });
        });
    </script>
</div>